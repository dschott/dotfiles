#!/usr/bin/env sh

if ! check-command vault curl; then
    exit 1
fi

environment="${1}"; shift
client_id="${1}"; shift

if [ -z "${environment}" ]; then
    echo >&2 "expected environment: nonprod | prod"
    exit 1
fi

case "${client_id}" in
"")
    echo "expected ping client_id" >&2
    exit 1
    ;;
"product360")
    token_file="${HOME}/.vault-token"
    ;;
*)
    token_file="${HOME}/.ping/${environment}_${client_id}" 
    ;;
esac

if [ ! -f "${token_file}" ]; then
    echo >&2 "token not found"
    exit 1
fi

echo "Authorization: bearer $(cat "${token_file}")"
