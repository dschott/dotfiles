#!/usr/bin/env bash

env-setlocal() {
    if [ -z "$1" ]; then
        >&2 echo "environment variable name is required."
        return 1
    fi

    var=${1}
    val=$(sed -n "s/^export ${var}=\(.*\)/\1/p" "${HOME}/.bashrc.local")

    if [ -n "${val}" ]; then
        read -rp "enter ${var} (${val}): " entered
    else
        read -rp "enter ${var}: " entered
    fi

    if [ -n "${entered}" ]; then
        val="${entered}"
    fi

    if [ -n "${val}" ]; then
        set-line "export ${var}=" "export ${var}=${val}" "${HOME}/.bashrc.local"
        . "${HOME}/.bashrc.local"
    fi
}

path-add() {
    if [ -z "${1}" ]; then
        >&2 echo "a path is required"
    else
        esc_path=$(regex-esc "${1}")
        if ! echo "${PATH}" | grep -qe "${esc_path}[:$]"; then
            export PATH="${1}:${PATH}"
        fi
    fi
}

path-remove() {
    if [ -z "${1}" ]; then
        >&2 echo "a path is required"
    else
        PATH=$(echo "${PATH}" | sed -E -e "s;:${1};;" -e "s;${1}:?;;")
        export PATH
    fi
}
