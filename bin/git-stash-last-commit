#!/usr/bin/env sh

! command-exists git && exit

if git-has-changes; then
    echo "local changes found. aborting!"
    exit 1
fi

message="$(git log --pretty=format:"%s" -1)"

echo "Stashing with message '${message}'"

git reset --soft HEAD~1
git stash save "${message}"

echo "git log"
git log --pretty=format:"%s" -4

echo "git stash"
git stash list --pretty=format:"%s" -4
