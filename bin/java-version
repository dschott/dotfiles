#!/usr/bin/env sh

if command -v javac > /dev/null
    then
        current_version="$(javac -version 2>&1 | sed -n 's/javac \(.*\)/\1/p')"
    else
        current_version="-"
    fi

    case "$(uname -s)" in
    Darwin)
        if versions=$(/usr/libexec/java_home -V 2>&1)
        then
            versions=$(echo ${versions} | sed -n 's/.*"\(.*\)".*/\1/p')
        else
            versions=''
        fi
        ;;
    Linux)
        versions=$(update-java-alternatives -l)
        ;;
    esac

    [ -n "${versions}" ] || exit

    if [ -z "${1}" ]
    then
        echo "current version:"
        echo "    ${current_version}"
        echo
        echo "available versions:"
        # shellcheck disable=SC2001
        echo "${versions}" | sed 's/^/    /'
        exit
    fi

    case "$(uname -s)" in
    Darwin)
        JAVA_HOME=$(/usr/libexec/java_home -v "${1}")
        export JAVA_HOME
        ;;
    Linux)
        sudo update-java-alternatives -s "${1}"
        ;;
    esac
fi