#!/usr/bin/env bash

if ! check-command /opt/cisco/anyconnect/bin/vpn; then
    exit 1
fi

host=${1}

if [ -z "${host}" ]; then
    hosts=$(vpn-hosts)
    default=$(echo "${hosts}" | head -1)
    
    printf "Available hosts:\n\n%s\n\n" "${hosts}"
    read  -rp "Host (${default}): " host
    host=${host:-${default}}
fi

if [ -n "${host}" ]; then
    vpn-client-kill
    /opt/cisco/anyconnect/bin/vpn -s connect "${host}"
fi
