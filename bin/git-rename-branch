#!/usr/bin/env bash

! command-exists git && exit

new_name=${1:?Specify a new branch name}

old_name=$(git-branch)
remote=$(git-remote)

if [ "${old_name}" = "master" ] || [ "${old_name}" = "develop" ]; then
    >&2 echo "Yeah. Not gonna rename this branch!"
    exit 1
fi

read -rp "Rename branch ${old_name} to ${new_name} locally and on remote ${remote}? (y/n) " rename

if [ -n "${rename}" ]; then
    git branch -m "${new_name}"
    git push "${remote}" :"${old_name}" "${new_name}"
    git push "${remote}" -u "${new_name}"
fi
