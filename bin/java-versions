#!/usr/bin/env sh

if command-exists javac; then
    current_version="$(javac -version 2>&1)"
else
    current_version="-"
fi

if os-is-darwin; then
    # Ref: http://www.jayway.com/2014/01/15/how-to-switch-jdk-version-on-mac-os-x-maverick/
    if [ -z "$1" ]; then
        printf "Current Version:\n    ${current_version}\n\nAvailable Versions:\n$(/usr/libexec/java_home -V 2>&1 | grep Library)\n"
    elif . sh-is-subshell; then
        echo "$0 must be sourced"
    else
        . path-remove '/System/Library/Frameworks/JavaVM.framework/Home/bin'

        if [ -n "${JAVA_HOME+x}" ]; then
            . path-remove ${JAVA_HOME}
        fi

        export JAVA_HOME=`/usr/libexec/java_home -v $@`

        . path-add "${JAVA_HOME}/bin"
    fi
elif os-is-debian; then
    if [ -z "$1" ]; then
        echo "current version:"
        echo "    ${current_version}"
        echo
        echo "available versions:"
        update-java-alternatives -l | sed 's/^/    /'
    else
        sudo update-java-alternatives -s "${1}"
    fi
fi
